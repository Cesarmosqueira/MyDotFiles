import electron from 'electron';
import is from 'electron-is';
import _ from 'lodash';

const app = is.main() ? electron.app : electron.remote.app;

function formatDataType(dataType) {
    return ['html', 'rtf'].includes(dataType)
        ? dataType.toUpperCase()
        : _.upperFirst(dataType);
}

export default {
    quit: app.quit,
    exit: app.exit,
    relaunch: app.relaunch,
    focus: app.focus,
    hide: app.hide,
    show: app.show,
    showItemInFolder: electron.shell.showItemInFolder,
    openItem: electron.shell.openItem,
    openExternal: electron.shell.openExternal,
    moveItemToTrash: electron.shell.moveItemToTrash,
    readClipboard: (dataType = 'text') => electron.clipboard[`read${formatDataType(dataType)}`](),
    writeClipboard: (content, dataType = 'text') => electron.clipboard.write({ [dataType]: content }),
    clearClipboard: electron.clipboard.clear,
};