import { requireShared } from '../plug-utils';
import PlugModule from 'plug-module';
import Store from 'electron-store';

const mod = new PlugModule('store');
const LocalStore = requireShared('plug-store').Store;
const defaultStore = new LocalStore('__DEFAULT__');

const api = {
    get: defaultStore.get.bind(defaultStore),
    set: defaultStore.set.bind(defaultStore),
    delete: defaultStore.delete.bind(defaultStore),
    has: defaultStore.has.bind(defaultStore),
    clear: defaultStore.clear.bind(defaultStore),
    onStoreChange: defaultStore.onChange.bind(defaultStore),
    LocalStore,
    Store,
};

mod.addMethod(api);
mod.injectMethodsToGlobal();

mod.injectGetterAndSetterToGlobal('storeSize', () => defaultStore.size);
mod.injectGetterAndSetterToGlobal('store', () => defaultStore.store, value => defaultStore.store = value);

export default mod.exportModule();